import { Injectable } from '@angular/core';
import { BehaviorSubject, Observable } from 'rxjs';

// Define translation interfaces
export interface Translations {
  [key: string]: string;
}

export interface LanguageTranslations {
  [locale: string]: Translations;
}

@Injectable({
  providedIn: 'root'
})
export class TranslationService {
  private currentTranslationsSubject = new BehaviorSubject<Translations>({});
  public currentTranslations$ = this.currentTranslationsSubject.asObservable();
  
  private translations: LanguageTranslations = {
    en: {
      'landing.hero.title': 'Transform Documents into Smart Forms',
      'landing.hero.subtitle': 'AI-powered form generation from PDFs with blockchain verification',
      'landing.search.title': 'Verify FormBT on Blockchain',
      'landing.search.placeholder': 'Enter form URL or ID',
      'landing.verify.button': 'Verify',
      'landing.verifying.button': 'Verifying...',
      'landing.verified.button': 'Verified',
      'landing.reset.button': 'Reset',
      'nav.dashboard': 'Dashboard',
      'nav.forms': 'Forms',
      'nav.form-data': 'Form Data',
      'nav.recipients': 'Recipients',
      'nav.ask-ai': 'Ask FormBT AI',
      'nav.settings': 'Settings',
      'sidebar.recent-forms': 'Recent Forms',
      'sidebar.search-placeholder': 'Search forms...',
      'sidebar.clear-search': 'Clear search',
      'sidebar.loading': 'Loading...',
      'sidebar.retry': 'Retry',
      'sidebar.forms.count.single': 'form',
      'sidebar.forms.count.plural': 'forms',
      'sidebar.no-forms-found': 'No forms found.',
      'sidebar.no-forms-yet': 'No forms yet.',
      'sidebar.untitled-form': 'Untitled Form',
      'sidebar.fields.single': 'field',
      'sidebar.fields.plural': 'fields',
      'sidebar.view-all': 'View All Forms',
      'tooltip.dashboard': 'Dashboard',
      'tooltip.forms': 'Forms',
      'tooltip.form-data': 'Form Data',
      'tooltip.recipients': 'Recipients',
      'tooltip.ask-ai': 'Ask FormBT AI',
      'language.select': 'Select Language',
      'forms.title': 'Forms',
      'forms.description': 'View and manage all your forms',
      'forms.search.placeholder': 'Search forms...',
      'forms.create.button': 'Create New Form',
      'forms.loading': 'Loading forms...',
      'recipients.toggle.recipients': 'Recipients',
      'recipients.toggle.groups': 'Groups',
      'recipients.add.button': 'Add Recipient',
      'recipients.export.button': 'Export',
      'ai.title': 'Ask FormBT AI',
      'ai.clear.tooltip': 'Clear chat',
      'ai.clear.label': 'Clear chat',
      'ai.subtitle': 'Get instant help with forms, data extraction, and FormBT features',
      'dashboard.file.select': 'Select PDF File',
      'dashboard.drag.drop': 'Or drag and drop a PDF file here',
      'dashboard.file.hint': 'Please select a PDF file to continue (max 10MB)',
      'dashboard.file.selected': 'Selected File:',
      'forms.search.clear': 'Clear search',
      'header.welcome': 'Welcome,',
      'header.logout': 'Logout',
      'header.default.subtitle': 'Form Viewer',
      'header.dashboard.subtitle': 'Dynamic Form Generator',
      'header.settings.subtitle': 'Settings',
      'settings.title': 'Settings',
      'settings.description': 'Manage your application preferences and configuration',
      'settings.language.title': 'Language & Region',
      'settings.language.subtitle': 'Choose your preferred language for the application',
      'settings.language.label': 'Application Language',
      'settings.language.hint': 'Select the language for the user interface',
      'settings.theme.title': 'Appearance',
      'settings.theme.subtitle': 'Customize the look and feel of the application',
      'settings.theme.label': 'Theme Mode',
      'settings.theme.hint': 'Choose between light and dark mode',
      'settings.theme.light': 'Light',
      'settings.theme.dark': 'Dark',
      'settings.notifications.title': 'Notifications',
      'settings.notifications.subtitle': 'Configure how you receive notifications',
      'settings.notifications.email.label': 'Email Notifications',
      'settings.notifications.email.hint': 'Receive notifications about form submissions and updates',
      'settings.notifications.browser.label': 'Browser Notifications',
      'settings.notifications.browser.hint': 'Show desktop notifications for important updates',
      'settings.privacy.title': 'Data & Privacy',
      'settings.privacy.subtitle': 'Manage your data preferences and privacy settings',
      'settings.privacy.analytics.label': 'Usage Analytics',
      'settings.privacy.analytics.hint': 'Help improve DynaForm by sharing anonymous usage data',
      'settings.privacy.autosave.label': 'Auto-save Forms',
      'settings.privacy.autosave.hint': 'Automatically save form changes as you work'
    },
    zh: {
      'landing.hero.title': '将文档转换为智能表单',
      'landing.hero.subtitle': '基于人工智能的PDF表单生成，具有区块链验证功能',
      'landing.search.title': '在区块链上验证FormBT',
      'landing.search.placeholder': '输入FormBT表单URL或ID',
      'landing.verify.button': '验证',
      'landing.verifying.button': '验证中...',
      'landing.verified.button': '已验证',
      'landing.reset.button': '重置',
      'nav.dashboard': '仪表板',
      'nav.forms': '表单',
      'nav.form-data': '表单数据',
      'nav.recipients': '收件人',
      'nav.ask-ai': '询问FormBT AI',
      'nav.settings': '设置',
      'sidebar.recent-forms': '最近的表单',
      'sidebar.search-placeholder': '搜索表单...',
      'sidebar.clear-search': '清除搜索',
      'sidebar.loading': '加载中...',
      'sidebar.retry': '重试',
      'sidebar.forms.count.single': '个表单',
      'sidebar.forms.count.plural': '个表单',
      'sidebar.no-forms-found': '未找到表单。',
      'sidebar.no-forms-yet': '还没有表单。',
      'sidebar.untitled-form': '无标题表单',
      'sidebar.fields.single': '个字段',
      'sidebar.fields.plural': '个字段',
      'sidebar.view-all': '查看所有表单',
      'tooltip.dashboard': '仪表板',
      'tooltip.forms': '表单',
      'tooltip.form-data': '表单数据',
      'tooltip.recipients': '收件人',
      'tooltip.ask-ai': '询问FormBT AI',
      'language.select': '选择语言',
      'forms.title': '表单',
      'forms.description': '查看和管理您的所有表单',
      'forms.search.placeholder': '搜索表单...',
      'forms.create.button': '创建新表单',
      'forms.loading': '加载表单中...',
      'recipients.toggle.recipients': '收件人',
      'recipients.toggle.groups': '群组',
      'recipients.add.button': '添加收件人',
      'recipients.export.button': '导出',
      'ai.title': '询问FormBT AI',
      'ai.clear.tooltip': '清除聊天',
      'ai.clear.label': '清除聊天',
      'ai.subtitle': '获取关于表单、数据提取和FormBT功能的即时帮助',
      'dashboard.file.select': '选择PDF文件',
      'dashboard.drag.drop': '或者拖放PDF文件到这里',
      'dashboard.file.hint': '请选择一个PDF文件继续（最大10MB）',
      'dashboard.file.selected': '选定的文件：',
      'forms.search.clear': '清除搜索',
      'header.welcome': '欢迎，',
      'header.logout': '登出',
      'header.default.subtitle': '表单查看器',
      'header.settings.subtitle': '设置',
      'settings.title': '设置',
      'settings.description': '管理您的应用程序偏好设置和配置',
      'settings.language.title': '语言和地区',
      'settings.language.subtitle': '为应用程序选择您的首选语言',
      'settings.language.label': '应用程序语言',
      'settings.language.hint': '为用户界面选择语言',
      'settings.theme.title': '外观',
      'settings.theme.subtitle': '自定义应用程序的外观和感觉',
      'settings.theme.label': '主题模式',
      'settings.theme.hint': '在明暗模式之间选择',
      'settings.theme.light': '明亮',
      'settings.theme.dark': '暗黑',
      'settings.notifications.title': '通知',
      'settings.notifications.subtitle': '配置您接收通知的方式',
      'settings.notifications.email.label': '电子邮件通知',
      'settings.notifications.email.hint': '接收关于表单提交和更新的通知',
      'settings.notifications.browser.label': '浏览器通知',
      'settings.notifications.browser.hint': '显示重要更新的桌面通知',
      'settings.privacy.title': '数据和隐私',
      'settings.privacy.subtitle': '管理您的数据偏好设置和隐私设置',
      'settings.privacy.analytics.label': '使用分析',
      'settings.privacy.analytics.hint': '通过分享匿名使用数据帮助改进DynaForm',
      'settings.privacy.autosave.label': '自动保存表单',
      'settings.privacy.autosave.hint': '在您工作时自动保存表单更改'
    },
    es: {
      'landing.hero.title': 'Transformar Documentos en Formularios Inteligentes',
      'landing.hero.subtitle': 'Generación de formularios con IA desde PDFs con verificación blockchain',
      'landing.search.title': 'Verificar DynaForm en Blockchain',
      'landing.search.placeholder': 'Ingrese URL o ID del formulario DynaForm',
      'landing.verify.button': 'Verificar',
      'landing.verifying.button': 'Verificando...',
      'landing.verified.button': 'Verificado',
      'landing.reset.button': 'Restablecer',
      'nav.dashboard': 'Panel de Control',
      'nav.forms': 'Formularios',
      'nav.form-data': 'Datos de Formulario',
      'nav.recipients': 'Destinatarios',
      'nav.ask-ai': 'Preguntar a DynaForm AI',
      'nav.settings': 'Configuración',
      'sidebar.recent-forms': 'Formularios Recientes',
      'sidebar.search-placeholder': 'Buscar formularios...',
      'sidebar.clear-search': 'Limpiar búsqueda',
      'sidebar.loading': 'Cargando...',
      'sidebar.retry': 'Reintentar',
      'sidebar.forms.count.single': 'formulario',
      'sidebar.forms.count.plural': 'formularios',
      'sidebar.no-forms-found': 'No se encontraron formularios.',
      'sidebar.no-forms-yet': 'Aún no hay formularios.',
      'sidebar.untitled-form': 'Formulario Sin Título',
      'sidebar.fields.single': 'campo',
      'sidebar.fields.plural': 'campos',
      'sidebar.view-all': 'Ver Todos los Formularios',
      'tooltip.dashboard': 'Panel de Control',
      'tooltip.forms': 'Formularios',
      'tooltip.form-data': 'Datos de Formulario',
      'tooltip.recipients': 'Destinatarios',
      'tooltip.ask-ai': 'Preguntar a DynaForm AI',
      'language.select': 'Seleccionar Idioma',
      'forms.title': 'Formularios',
      'forms.description': 'Ver y gestionar todos sus formularios',
      'forms.search.placeholder': 'Buscar formularios...',
      'forms.create.button': 'Crear Nuevo Formulario',
      'forms.loading': 'Cargando formularios...',
      'recipients.toggle.recipients': 'Destinatarios',
      'recipients.toggle.groups': 'Grupos',
      'recipients.add.button': 'Agregar Destinatario',
      'recipients.export.button': 'Exportar',
      'ai.title': 'Preguntar a DynaForm AI',
      'ai.clear.tooltip': 'Limpiar chat',
      'ai.clear.label': 'Limpiar chat',
      'ai.subtitle': 'Obtener ayuda instantánea con formularios, extracción de datos y funciones de DynaForm',
      'dashboard.file.select': 'Seleccionar Archivo PDF',
      'dashboard.drag.drop': 'O arrastrar y soltar un archivo PDF aquí',
      'dashboard.file.hint': 'Por favor seleccione un archivo PDF para continuar (máx 10MB)',
      'dashboard.file.selected': 'Archivo Seleccionado:',
      'forms.search.clear': 'Limpiar búsqueda',
      'header.welcome': 'Bienvenido,',
      'header.logout': 'Cerrar Sesión',
      'header.default.subtitle': 'Visor de Formularios',
      'header.settings.subtitle': 'Configuración',
      'settings.title': 'Configuración',
      'settings.description': 'Gestionar sus preferencias y configuración de la aplicación',
      'settings.language.title': 'Idioma y Región',
      'settings.language.subtitle': 'Elija su idioma preferido para la aplicación',
      'settings.language.label': 'Idioma de la Aplicación',
      'settings.language.hint': 'Seleccione el idioma para la interfaz de usuario',
      'settings.theme.title': 'Apariencia',
      'settings.theme.subtitle': 'Personalizar la apariencia de la aplicación',
      'settings.theme.label': 'Modo de Tema',
      'settings.theme.hint': 'Elegir entre modo claro y oscuro',
      'settings.theme.light': 'Claro',
      'settings.theme.dark': 'Oscuro',
      'settings.notifications.title': 'Notificaciones',
      'settings.notifications.subtitle': 'Configurar cómo recibir notificaciones',
      'settings.notifications.email.label': 'Notificaciones por Email',
      'settings.notifications.email.hint': 'Recibir notificaciones sobre envíos y actualizaciones de formularios',
      'settings.notifications.browser.label': 'Notificaciones del Navegador',
      'settings.notifications.browser.hint': 'Mostrar notificaciones de escritorio para actualizaciones importantes',
      'settings.privacy.title': 'Datos y Privacidad',
      'settings.privacy.subtitle': 'Gestionar sus preferencias de datos y configuración de privacidad',
      'settings.privacy.analytics.label': 'Análisis de Uso',
      'settings.privacy.analytics.hint': 'Ayudar a mejorar DynaForm compartiendo datos de uso anónimos',
      'settings.privacy.autosave.label': 'Guardar Automáticamente Formularios',
      'settings.privacy.autosave.hint': 'Guardar automáticamente los cambios del formulario mientras trabaja'
    }
  };

  constructor() {
    // Initialize with English translations
    this.currentTranslationsSubject.next(this.translations['en']);
  }

  setLanguage(locale: string): void {
    const translations = this.translations[locale] || this.translations['en'];
    this.currentTranslationsSubject.next(translations);
  }

  getTranslation(key: string): string {
    const currentTranslations = this.currentTranslationsSubject.value;
    return currentTranslations[key] || key;
  }

  instant(key: string): string {
    return this.getTranslation(key);
  }
}
